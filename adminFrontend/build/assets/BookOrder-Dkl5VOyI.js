import{r,j as e}from"./index-DaKUt_DV.js";import{a as p}from"./index-BDD5Wvo_.js";import{F as y,h as _,g as F}from"./index-DDtXgTNU.js";import{C as A,a as D}from"./CCardBody-4OFbAYXQ.js";import{C as H,a as I,b as L,c as b,d as o,e as R,f as l}from"./CTable-CGk0PLLg.js";import{C as w}from"./CForm-MRPvJMuP.js";import{b as S,C as z,a as P}from"./CRow-sBPEtvTW.js";import{C as U,a as V,b as $,c as q,d as G}from"./CModalTitle-DBM11O6T.js";import{a as v}from"./CButton-DH5yodee.js";import"./axios-DNDjIgWp.js";import"./CConditionalPortal-Cw5Vw1E-.js";const re=()=>{const[n,i]=r.useState([]),[O,u]=r.useState(!0),[x,d]=r.useState(""),[N,c]=r.useState(!1),[m,j]=r.useState(!1),[f,C]=r.useState(null),[h,T]=r.useState("");r.useEffect(()=>{g()},[]),r.useEffect(()=>{const s=setTimeout(()=>{g()},300);return()=>clearTimeout(s)},[h]);const g=async()=>{try{const s=await p.post("https://www.panel.efe-travel.com/api/Booking/",{searchName:h}),t=s.data.map(a=>({_id:a._id,name:a.name,message:a.message,date:new Date(a.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),time:a.time,vnumber:a.vnumber,email:a.email,paymentStatus:a.paymentStatus}));console.log(t),i(t),u(!1),console.log(s.data)}catch(s){console.error("Error fetching orders:",s),u(!1)}},B=s=>{T(s.target.value)},E=async s=>{try{await p.delete(`https://www.panel.efe-travel.com/api/Booking/${s}`),i(n.filter(t=>t._id!==s))}catch(t){console.error("Error deleting order:",t)}},k=s=>{d(s.name),j(!0),C(s._id),c(!0)},M=async()=>{const s={name:x};try{const t=await p.put(`https://www.panel.efe-travel.com/api/Booking/${f}`,s);i(n.map(a=>a._id===f?{...a,...t.data}:a)),d(""),j(!1),C(null),c(!1),window.alert("Order successfully updated")}catch(t){console.error("Error updating order:",t)}};return O?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsxs(H,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h1",{style:{fontSize:"24px",color:"chocolate"},children:"Book Order List"}),e.jsx(w,{className:"d-flex align-items-center",children:e.jsx(S,{type:"text",placeholder:"Search by Name",value:h,onChange:B,className:"me-2"})})]}),e.jsx(D,{children:n.length===0?e.jsx("div",{children:"No orders found."}):e.jsxs(I,{striped:!0,hover:!0,bordered:!0,responsive:!0,children:[e.jsx(L,{children:e.jsxs(b,{children:[e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"Email"}),e.jsx(o,{scope:"col",children:"Message"}),e.jsx(o,{scope:"col",children:"Date"}),e.jsx(o,{scope:"col",children:"Time"}),e.jsx(o,{scope:"col",children:"Vehicle Number"}),e.jsx(o,{scope:"col",children:"Payment Status"}),e.jsx(o,{scope:"col",children:"Actions"})]})}),e.jsx(R,{children:n.map(s=>e.jsxs(b,{children:[e.jsx(l,{children:s.name}),e.jsx(l,{children:s.email}),e.jsx(l,{children:s.message}),e.jsx(l,{children:s.date}),e.jsx(l,{children:s.time}),e.jsx(l,{children:s.vnumber}),e.jsx(l,{children:s.paymentStatus}),e.jsxs(l,{children:[e.jsx(y,{icon:_,style:{color:"#b3ae0f",cursor:"pointer",marginRight:"10px"},onClick:()=>k(s)}),e.jsx(y,{icon:F,style:{color:"#bb1616",cursor:"pointer"},onClick:()=>E(s._id)})]})]},s._id))})]})})]}),e.jsxs(U,{size:"lg",visible:N,onClose:()=>c(!1),children:[e.jsx(V,{closeButton:!0,children:e.jsx($,{children:m?"Edit Order":"Add Order"})}),e.jsx(q,{children:e.jsx(w,{children:e.jsx(z,{className:"mb-3",children:e.jsx(P,{children:e.jsx(S,{type:"text",value:x,onChange:s=>d(s.target.value),placeholder:"Name"})})})})}),e.jsxs(G,{children:[e.jsx(v,{color:"primary",onClick:m?M:null,children:m?"Update":"Add"})," ",e.jsx(v,{color:"secondary",onClick:()=>c(!1),children:"Cancel"})]})]})]})};export{re as default};
